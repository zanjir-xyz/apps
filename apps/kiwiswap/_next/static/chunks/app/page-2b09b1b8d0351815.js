(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3061:(e,t,a)=>{Promise.resolve().then(a.bind(a,9492)),Promise.resolve().then(a.bind(a,6036))},9492:(e,t,a)=>{"use strict";a.d(t,{AnimatedBackground:()=>n});var r=a(5155),s=a(2115);function n(){let[e,t]=(0,s.useState)([]);return(0,s.useEffect)(()=>{let e=[];for(let t=0;t<10;t++)e.push({id:t,x:100*Math.random(),y:100*Math.random(),size:30*Math.random()+20,speed:10*Math.random()+5,direction:360*Math.random()});t(e);let a=setInterval(()=>{t(e=>e.map(e=>{let t=e.direction*(Math.PI/180),a=e.x+.2*Math.cos(t),r=e.y+.2*Math.sin(t),s=e.direction;return(a<0||a>100)&&(s=180-s,a=Math.max(0,Math.min(100,a))),(r<0||r>100)&&(s=360-s,r=Math.max(0,Math.min(100,r))),s+=(Math.random()-.5)*10,{...e,x:a,y:r,direction:s}}))},50);return()=>clearInterval(a)},[]),(0,r.jsxs)("div",{className:"fixed inset-0 overflow-hidden -z-10",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-background/80 backdrop-blur-md"}),e.map(e=>(0,r.jsx)("div",{className:"absolute select-none pointer-events-none text-primary/10",style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"%"),fontSize:"".concat(e.size,"px"),transition:"all ".concat(e.speed/20,"s ease-in-out"),transform:"rotate(".concat(e.direction,"deg)")},children:"\uD83E\uDD5D"},e.id))]})}},6036:(e,t,a)=>{"use strict";a.d(t,{SwapInterface:()=>tn});var r=a(5155),s=a(2115);let n=e=>{let t=Number.parseFloat(e);return isNaN(t)?"0":t.toFixed(6)};function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter(Boolean).join(" ")}let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:i("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});o.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:i("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:i("text-2xl font-semibold leading-none tracking-tight",a),...s})});c.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:i("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:i("p-6 pt-0",a),...s})});u.displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:i("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter";var m=a(8629);let f=m.bL,x=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(m.B8,{ref:t,className:i("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...s})});x.displayName=m.B8.displayName;let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(m.l9,{ref:t,className:i("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...s})});h.displayName=m.l9.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(m.UC,{ref:t,className:i("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...s})});p.displayName=m.UC.displayName;var g=a(4505),w=a(2317),v=a(6421);let y=(0,v.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),N=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:o=!1,...l}=e,c=o?w.DX:"button";return(0,r.jsx)(c,{className:i(y({variant:s,size:n,className:a})),ref:t,...l})});N.displayName="Button";var b=a(5620),j=a(5236),A=a(8268),k=a(8808),S=a(8982),B=a(1525);let F={chainId:"0x2f145",chainName:"Zanjir Network",nativeCurrency:{name:"Ethereum",symbol:"ETH",decimals:18},rpcUrls:["https://rpc.zanjir.xyz"],blockExplorerUrls:["https://zanjir.xyz/explorer"]},E=["function getPool(address _tokenA, address _tokenB) public view returns (address)","function createPoolIfNotExists(address _tokenA, address _tokenB) external returns (address)"],C=["function addLiquidity(uint256 amountADesired, uint256 amountBDesired) external returns (uint256)","function calculateRemoveLiquidity(uint256 liquidity) public view returns (uint256 amountA, uint256 amountB)","function removeLiquidity(uint256 liquidity) external returns (uint256 amountA, uint256 amountB)","function swapAForB(uint256 amountAIn, uint256 minAmountBOut) external returns (uint256)","function swapBForA(uint256 amountBIn, uint256 minAmountAOut) external returns (uint256)","function calculateSwapAForB(uint256 amountAIn) public view returns (uint256)","function calculateSwapBForA(uint256 amountBIn) public view returns (uint256)","function approxAForB(uint256 amountIn) public view returns (uint256 amountOut)","function approxBForA(uint256 amountIn) public view returns (uint256 amountOut)","function getExchangeRate() external view returns (uint256, uint256)","function reserveA() view returns (uint256)","function reserveB() view returns (uint256)","function tokenA() view returns (address)","function tokenB() view returns (address)","function balanceOf(address account) view returns (uint256)","function totalSupply() view returns (uint256)","event Swap(address indexed user, bool isAToB, uint256 amountIn, uint256 amountOut)"],T=["function balanceOf(address owner) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)","function name() view returns (string)","function transfer(address to, uint amount) returns (bool)","function approve(address spender, uint256 amount) returns (bool)","function allowance(address owner, address spender) view returns (uint256)","function totalSupply() view returns (uint256)"],I={SOL:"0x36E6dc3CF44FDb8C62c5a11B457A28041f4C6eEF",ETH:"0xFFfFfFffFFfffFFfFFfFFFFFffFFFffffFfFFFfF",USDT:"0x9ac37093d6eF6cb5fC0944DCed3AA56eBCE050cb",IRT:"0x09E5DCF3872DD653c4CCA5378AbA77088457A8a9",DOGE:"0xC7d2B19934594c43b6ec678507Df24D49e7e2F69",BTC:"0x3B05FB2fA2AE1447f61A0456f102350626A69f0b"},O={};async function L(e){if(O[e.toLowerCase()])return O[e.toLowerCase()];try{let t=await V(e),a=await t.symbol();return O[e.toLowerCase()]=a,a}catch(t){return console.error("Error fetching token symbol:",t),e.substring(0,6)+"..."+e.substring(e.length-4)}}async function R(){if(!window.ethereum)throw Error("MetaMask یا کیف پول سازگار با Web3 یافت نشد");try{return await window.ethereum.request({method:"eth_chainId"})===F.chainId}catch(e){return console.error("خطا در بررسی شبکه:",e),!1}}async function D(){if(!window.ethereum)throw Error("MetaMask یا کیف پول سازگار با Web3 یافت نشد");try{return await window.ethereum.request({method:"wallet_addEthereumChain",params:[F]}),!0}catch(e){throw console.error("خطا در افزودن شبکه Zanjir:",e),e}}async function _(){if(!window.ethereum)throw Error("MetaMask یا کیف پول سازگار با Web3 یافت نشد");try{return await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:F.chainId}]}),!0}catch(e){if(4902===e.code)return await D();throw console.error("خطا در تغییر به شبکه Zanjir:",e),e}}function U(){if(!window.ethereum)throw Error("MetaMask یا کیف پول سازگار با Web3 یافت نشد");return void 0!==A.providers?new A.providers.Web3Provider(window.ethereum):new k.k(window.ethereum)}async function M(){if(!window.ethereum)throw Error("MetaMask یا کیف پول سازگار با Web3 یافت نشد");try{await R()||await _();let e=await window.ethereum.request({method:"eth_requestAccounts"});if(0===e.length)throw Error("هیچ حسابی انتخاب نشد");return e[0]}catch(e){throw console.error("خطا در اتصال به کیف پول:",e),e}}async function P(){return!0}async function q(){if(!window.ethereum)return{connected:!1,account:null};try{let e=await window.ethereum.request({method:"eth_accounts"});return{connected:e.length>0,account:e.length>0?e[0]:null}}catch(e){return console.error("خطا در بررسی وضعیت اتصال کیف پول:",e),{connected:!1,account:null}}}async function z(){try{let e;await R()||await _(),await window.ethereum.request({method:"eth_requestAccounts"});let t=U();e=void 0!==A.providers?t.getSigner():await t.getSigner();let a=new S.NZ("0x42D4BA5e542d9FeD87EA657f0295F1968A61c00A",E,e);return{provider:t,signer:e,contract:a}}catch(e){throw console.error("خطا در اتصال به قرارداد مدیریت استخر:",e),e}}function H(e,t){return e.toLowerCase()<t.toLowerCase()?{tokenA:e,tokenB:t,swapped:!1}:{tokenA:t,tokenB:e,swapped:!0}}async function J(e,t){try{let{tokenA:a,tokenB:r}=H(e,t),{contract:s}=await z(),n=await s.getPool(a,r);return"0x0000000000000000000000000000000000000000"!==n}catch(e){return console.error("خطا در بررسی وجود استخر:",e),!1}}async function Z(e,t){try{let{tokenA:a,tokenB:r}=H(e,t),{contract:s}=await z(),n=await s.createPoolIfNotExists(a,r);await n.wait();let i=await J(a,r);if(!i)throw Error("ایجاد استخر با شکست مواجه شد");return i}catch(e){throw console.error("خطا در ایجاد استخر:",e),e}}async function X(e,t){try{let{tokenA:a,tokenB:r}=H(e,t),{contract:s}=await z(),n=await s.getPool(a,r);if("0x0000000000000000000000000000000000000000"===n)return null;return n}catch(e){return console.error("خطا در دریافت آدرس استخر:",e),null}}async function G(e,t){try{let{tokenA:a,tokenB:r}=H(e,t),{provider:s,signer:n,contract:i}=await z(),o=await i.getPool(a,r);if("0x0000000000000000000000000000000000000000"===o)throw Error("استخر برای این جفت توکن وجود ندارد");let l=new S.NZ(o,C,n);return{provider:s,signer:n,contract:l,address:o}}catch(e){throw console.error("خطا در اتصال به استخر:",e),e}}async function V(e){try{let t;let a=U();return t=void 0!==A.providers?a.getSigner():await a.getSigner(),new S.NZ(e,T,t)}catch(e){throw console.error("خطا در اتصال به توکن:",e),e}}async function W(e,t){try{let a=await V(e),r=await a.balanceOf(t),s=await a.decimals();if(void 0!==A.utils)return A.utils.formatUnits(r,s);return B.Js(r,s)}catch(e){return console.error("خطا در دریافت موجودی توکن:",e),"0"}}async function Y(e,t,a){try{let r;if(!t)throw Error("آدرس spender نامعتبر است");let s=await V(e),n=await s.decimals();r=void 0!==A.utils?A.utils.parseUnits(a,n):B.XS(a,n);let i=await s.approve(t,r);return await i.wait(),!0}catch(e){throw console.error("خطا در تایید توکن:",e),e}}async function K(e,t,a,r){try{let s,n;let{tokenA:i,tokenB:o,swapped:l}=H(e,t),c=l?r:a,d=l?a:r,u=await J(i,o);if(!u&&(await Z(i,o),!(u=await J(i,o))))throw Error("ایجاد استخر با شکست مواجه شد");let m=await X(i,o);if(!m)throw Error("آدرس استخر نامعتبر است");let{contract:f}=await G(i,o),x=await V(i),h=await V(o),p=await x.decimals(),g=await h.decimals();void 0!==A.utils?(s=A.utils.parseUnits(c,p),n=A.utils.parseUnits(d,g)):(s=B.XS(c,p),n=B.XS(d,g)),console.log("تایید توکن A برای استخر با آدرس:",m),await Y(i,m,c),console.log("تایید توکن B برای استخر با آدرس:",m),await Y(o,m,d);let w=await f.addLiquidity(s,n);return await w.wait(),!0}catch(e){throw console.error("خطا در افزودن نقدینگی:",e),e}}async function Q(e,t,a,r){try{let s,n;let{tokenA:i,tokenB:o,swapped:l}=H(e,t);if(!await J(i,o))throw Error("استخر برای این جفت توکن وجود ندارد");let c=await X(i,o);if(!c)throw Error("آدرس استخر نامعتبر است");let{contract:d}=await G(i,o),u=await V(i),m=await u.decimals(),f=await (await V(o)).decimals();void 0!==A.utils?(s=A.utils.parseUnits(a,m),n=A.utils.parseUnits(r,f)):(s=B.XS(a,m),n=B.XS(r,f)),await Y(i,c,a);let x=await d.swapAForB(s,n);return await x.wait(),!0}catch(e){throw console.error("خطا در مبادله توکن A به B:",e),e}}async function $(e,t,a,r){try{let s,n;let{tokenA:i,tokenB:o,swapped:l}=H(e,t);if(!await J(i,o))throw Error("استخر برای این جفت توکن وجود ندارد");let c=await X(i,o);if(!c)throw Error("آدرس استخر نامعتبر است");let{contract:d}=await G(i,o),u=await V(o),m=await u.decimals(),f=await (await V(i)).decimals();void 0!==A.utils?(s=A.utils.parseUnits(a,m),n=A.utils.parseUnits(r,f)):(s=B.XS(a,m),n=B.XS(r,f)),await Y(o,c,a);let x=await d.swapBForA(s,n);return await x.wait(),!0}catch(e){throw console.error("خطا در مبادله توکن B به A:",e),e}}async function ee(e,t,a){try{let{tokenA:r,tokenB:s}=H(e,t);if(!await J(r,s))return"0";let{contract:n}=await G(r,s),i=await n.balanceOf(a);if(void 0!==A.utils)return A.utils.formatEther(i);return B.ck(i)}catch(e){return console.error("خطا در دریافت تعداد توکن‌های LP:",e),"0"}}async function et(e,t){try{let{tokenA:a,tokenB:r}=H(e,t);if(!await J(a,r))return console.log("رویدادهای Swap: استخر برای این جفت توکن وجود ندارد"),[];let{contract:s,provider:n}=await G(a,r);if(!s||!s.filters)return console.error("Contract or filters not available"),[];if(void 0!==A.utils)try{if(!s.filters.Swap)return console.error("Swap event not found in contract"),[];let e=s.filters.Swap(),t=await n.getBlockNumber(),a=await s.queryFilter(e,t-1e4>0?t-1e4:0,t);return await Promise.all(a.map(async e=>{var t,a,r,s,i,o,l,c;try{let i=await n.getBlock(e.blockNumber);return{...e,blockTimestamp:i?i.timestamp:Math.floor(Date.now()/1e3),transactionHash:e.transactionHash,args:{...e.args,user:(null===(t=e.args)||void 0===t?void 0:t.user)||"",isAToB:(null===(a=e.args)||void 0===a?void 0:a.isAToB)===void 0||e.args.isAToB,amountIn:(null===(r=e.args)||void 0===r?void 0:r.amountIn)||A.BigNumber.from(0),amountOut:(null===(s=e.args)||void 0===s?void 0:s.amountOut)||A.BigNumber.from(0)}}}catch(t){return console.error("Error fetching block data:",t),{...e,blockTimestamp:Math.floor(Date.now()/1e3),transactionHash:e.transactionHash,args:{user:(null===(i=e.args)||void 0===i?void 0:i.user)||"",isAToB:(null===(o=e.args)||void 0===o?void 0:o.isAToB)===void 0||e.args.isAToB,amountIn:(null===(l=e.args)||void 0===l?void 0:l.amountIn)||A.BigNumber.from(0),amountOut:(null===(c=e.args)||void 0===c?void 0:c.amountOut)||A.BigNumber.from(0)}}}}))}catch(e){return console.error("Error processing events (ethers v5):",e),[]}else try{if(!s.interface.fragments.some(e=>"event"===e.type&&"Swap"===e.name))return console.error("Swap event not found in contract interface"),[];let e=BigInt(await n.getBlockNumber()),t=e-BigInt(1e4)>BigInt(0)?e-BigInt(1e4):BigInt(0),a=await s.queryFilter(s.filters.Swap,t,e);return await Promise.all(a.map(async e=>{try{let t=await n.getBlock(e.blockNumber);return{...e,blockTimestamp:Number((null==t?void 0:t.timestamp)||0),transactionHash:e.transactionHash,args:{user:e.args[0]||"",isAToB:void 0===e.args[1]||e.args[1],amountIn:e.args[2]||BigInt(0),amountOut:e.args[3]||BigInt(0)}}}catch(n){var t,a,r,s;return console.error("Error fetching block data:",n),{...e,blockTimestamp:Math.floor(Date.now()/1e3),transactionHash:e.transactionHash,args:{user:(null===(t=e.args)||void 0===t?void 0:t[0])||"",isAToB:(null===(a=e.args)||void 0===a?void 0:a[1])===void 0||e.args[1],amountIn:(null===(r=e.args)||void 0===r?void 0:r[2])||BigInt(0),amountOut:(null===(s=e.args)||void 0===s?void 0:s[3])||BigInt(0)}}}}))}catch(e){return console.error("Error processing events (ethers v6):",e),[]}}catch(e){return console.error("خطا در دریافت رویدادهای Swap:",e),[]}}async function ea(e,t,a){try{let r,s,n;let{tokenA:i,tokenB:o}=H(e,t);if(!await J(i,o))return{amountA:"0",amountB:"0"};let{contract:l}=await G(i,o);r=void 0!==A.utils?A.utils.parseEther(a):B.g5(a);let[c,d]=await l.calculateRemoveLiquidity(r),u=await V(i),m=await V(o),f=await u.decimals(),x=await m.decimals();return void 0!==A.utils?(s=A.utils.formatUnits(c,f),n=A.utils.formatUnits(d,x)):(s=B.Js(c,f),n=B.Js(d,x)),{amountA:s,amountB:n}}catch(e){return console.error("خطا در دریافت پیش‌بینی برداشت نقدینگی:",e),{amountA:"0",amountB:"0"}}}async function er(e,t,a){try{let r;let{tokenA:s,tokenB:n}=H(e,t);if(!await J(s,n))throw Error("استخر برای این جفت توکن وجود ندارد");if(!await X(s,n))throw Error("آدرس استخر نامعتبر است");let{contract:i}=await G(s,n),o=await V(s),l=await V(n);await o.decimals(),await l.decimals(),r=void 0!==A.utils?A.utils.parseEther(a):B.g5(a);let c=await i.removeLiquidity(r);return await c.wait(),!0}catch(e){throw console.error("خط در برداشت نقدینگی:",e),e}}async function es(e,t,a,r){try{let s,n,i;let{tokenA:o,tokenB:l}=H(e,t);if(!await J(o,l)){let e=Number.parseFloat(a),t=Number.parseFloat(r);if(isNaN(e)||isNaN(t)||e<=0||t<=0)return"0";return Math.sqrt(e*t).toString()}if(!await X(o,l))throw Error("آدرس استخر نامعتبر است");let{contract:c}=await G(o,l),d=await V(o),u=await V(l),m=await d.decimals(),f=await u.decimals();void 0!==A.utils?(s=A.utils.parseUnits(a,m),n=A.utils.parseUnits(r,f)):(s=B.XS(a,m),n=B.XS(r,f));let x=await c.reserveA(),h=await c.reserveB(),p=await c.totalSupply();if("0"===p.toString())i=void 0!==A.utils?A.utils.parseEther(Math.sqrt(Number(A.utils.formatUnits(s,m))*Number(A.utils.formatUnits(n,f))).toString()):B.g5(Math.sqrt(Number(B.Js(s,m))*Number(B.Js(n,f))).toString());else{if("0"===x.toString()||"0"===h.toString())return"0";if(void 0!==A.utils){let e=s.mul(p).div(x),t=n.mul(p).div(h);i=e.lt(t)?e:t}else{let e=BigInt(s.toString()),t=BigInt(n.toString()),a=BigInt(p.toString()),r=BigInt(x.toString()),o=BigInt(h.toString()),l=e*a/r,c=t*a/o;i=l<c?l:c}}if(void 0!==A.utils)return A.utils.formatEther(i);return B.ck(i)}catch(e){return console.error("خطا در تخمین تعداد توکن‌های LP:",e),"0"}}async function en(e,t,a,r){try{let s,n;let{tokenA:i,tokenB:o,swapped:l}=H(e,t);if(!await J(i,o))return"0";let{contract:c}=await G(i,o),d=await V(i),u=await V(o),m=await d.decimals(),f=await u.decimals();s=void 0!==A.utils?A.utils.parseUnits(a,r?m:f):B.XS(a,r?m:f),n=(l?!r:r)?await c.approxAForB(s):await c.approxBForA(s);let x=r?f:m;if(void 0!==A.utils)return A.utils.formatUnits(n,x);return B.Js(n,x)}catch(e){return console.error("خطا در محاسبه مقدار خروجی تقریبی:",e),null}}async function ei(e){try{let t=await V(e);try{await t.symbol()}catch(e){return console.error("Error calling symbol():",e),!1}try{await t.name()}catch(e){return console.error("Error calling name():",e),!1}try{await t.decimals()}catch(e){return console.error("Error calling decimals():",e),!1}return!0}catch(e){return console.error("خطا در بررسی اعتبار توکن ERC20:",e),!1}}async function eo(e){try{let t=await V(e),[a,r,s]=await Promise.all([t.symbol(),t.name(),t.decimals()]);return{symbol:a,name:r,decimals:Number(s)}}catch(e){throw console.error("خطا در دریافت اطلاعات توکن ERC20:",e),Error("خطا در دریافت اطلاعات توکن")}}var el=a(8321),ec=a(6967),ed=a(8867),eu=a(3565);let em=el.bL,ef=el.l9;el.YJ,el.ZL,el.Pb,el.z6,s.forwardRef((e,t)=>{let{className:a,inset:s,children:n,...o}=e;return(0,r.jsxs)(el.ZP,{ref:t,className:i("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",a),...o,children:[n,(0,r.jsx)(ec.A,{className:"ml-auto"})]})}).displayName=el.ZP.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(el.G5,{ref:t,className:i("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})}).displayName=el.G5.displayName;let ex=s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...n}=e;return(0,r.jsx)(el.ZL,{children:(0,r.jsx)(el.UC,{ref:t,sideOffset:s,className:i("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});ex.displayName=el.UC.displayName;let eh=s.forwardRef((e,t)=>{let{className:a,inset:s,...n}=e;return(0,r.jsx)(el.q7,{ref:t,className:i("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",a),...n})});eh.displayName=el.q7.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,checked:n,...o}=e;return(0,r.jsxs)(el.H_,{ref:t,className:i("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:n,...o,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(el.VF,{children:(0,r.jsx)(ed.A,{className:"h-4 w-4"})})}),s]})}).displayName=el.H_.displayName,s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(el.hN,{ref:t,className:i("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(el.VF,{children:(0,r.jsx)(eu.A,{className:"h-2 w-2 fill-current"})})}),s]})}).displayName=el.hN.displayName,s.forwardRef((e,t)=>{let{className:a,inset:s,...n}=e;return(0,r.jsx)(el.JU,{ref:t,className:i("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",a),...n})}).displayName=el.JU.displayName;let ep=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(el.wv,{ref:t,className:i("-mx-1 my-1 h-px bg-muted",a),...s})});function eg(e){let{connected:t,account:a,onConnect:n,onDisconnect:i}=e,[o,l]=(0,s.useState)(!1),c=async()=>{if(!t){l(!0);try{await R()||await _(),await M(),n()}catch(e){console.error("خطا در اتصال به کیف پول:",e)}finally{l(!1)}}},d=async()=>{try{await P(),i()}catch(e){console.error("خطا در قطع اتصال کیف پول:",e)}};return t?(0,r.jsxs)(em,{children:[(0,r.jsx)(ef,{asChild:!0,children:(0,r.jsxs)(N,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[(0,r.jsx)(b.A,{className:"h-4 w-4 ml-1"}),a?a?"".concat(a.substring(0,6),"...").concat(a.substring(a.length-4)):"":"متصل"]})}),(0,r.jsx)(ex,{align:"end",children:(0,r.jsxs)(eh,{onClick:d,className:"cursor-pointer text-destructive",children:[(0,r.jsx)(j.A,{className:"h-4 w-4 ml-2"}),"قطع اتصال"]})})]}):(0,r.jsxs)(N,{variant:"default",size:"sm",onClick:c,disabled:o,className:"flex items-center gap-1",children:[(0,r.jsx)(b.A,{className:"h-4 w-4 ml-1"}),o?"در حال اتصال...":"اتصال کیف پول"]})}function ew(e){let{onSwitchNetwork:t}=e;return(0,r.jsxs)("div",{className:"mt-2 p-2 bg-destructive/20 rounded-lg text-sm text-center",children:["لطفا به شبکه Zanjir متصل شوید",(0,r.jsx)(N,{variant:"link",className:"p-0 h-auto text-sm mr-2 text-primary",onClick:t,children:"تغییر شبکه"})]})}ep.displayName=el.wv.displayName;var ev=a(9577),ey=a(8617);let eN=s.forwardRef((e,t)=>{let{className:a,type:s,...n}=e;return(0,r.jsx)("input",{type:s,className:i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});eN.displayName="Input";var eb=a(6195);let ej=(0,v.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),eA=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eb.b,{ref:t,className:i(ej(),a),...s})});eA.displayName=eb.b.displayName;var ek=a(1719),eS=a(3473),eB=a(1594),eF=a(5565),eE=a(6217),eC=a(767);let eT=eE.bL;eE.l9;let eI=eE.ZL;eE.bm;let eO=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eE.hJ,{ref:t,className:i("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...s})});eO.displayName=eE.hJ.displayName;let eL=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(eI,{children:[(0,r.jsx)(eO,{}),(0,r.jsxs)(eE.UC,{ref:t,className:i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...n,children:[s,(0,r.jsxs)(eE.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});eL.displayName=eE.UC.displayName;let eR=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:i("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};eR.displayName="DialogHeader";let eD=e=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:i("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};eD.displayName="DialogFooter";let e_=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eE.hE,{ref:t,className:i("text-lg font-semibold leading-none tracking-tight",a),...s})});e_.displayName=eE.hE.displayName;let eU=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(eE.VY,{ref:t,className:i("text-sm text-muted-foreground",a),...s})});eU.displayName=eE.VY.displayName;let eM=0,eP=new Map,eq=e=>{if(eP.has(e))return;let t=setTimeout(()=>{eP.delete(e),eZ({type:"REMOVE_TOAST",toastId:e})},1e6);eP.set(e,t)},ez=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?eq(a):e.toasts.forEach(e=>{eq(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},eH=[],eJ={toasts:[]};function eZ(e){eJ=ez(eJ,e),eH.forEach(e=>{e(eJ)})}function eX(e){let{...t}=e,a=(eM=(eM+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>eZ({type:"DISMISS_TOAST",toastId:a});return eZ({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>eZ({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function eG(){let[e,t]=s.useState(eJ);return s.useEffect(()=>(eH.push(t),()=>{let e=eH.indexOf(t);e>-1&&eH.splice(e,1)}),[e]),{...e,toast:eX,dismiss:e=>eZ({type:"DISMISS_TOAST",toastId:e})}}let eV="kiwiswap_custom_tokens";function eW(e){let{defaultToken:t="ETH",onSelect:a}=e,[n,i]=(0,s.useState)(t),[o,l]=(0,s.useState)([{symbol:"SOL",name:"سولانا",logo:"https://cryptologos.cc/logos/solana-sol-logo.svg",address:I.SOL},{symbol:"ETH",name:"اتریوم",logo:"https://cryptologos.cc/logos/ethereum-eth-logo.svg",address:I.ETH},{symbol:"USDT",name:"تتر",logo:"https://cryptologos.cc/logos/tether-usdt-logo.svg",address:I.USDT},{symbol:"IRT",name:"تومان",logo:"/placeholder.svg?height=32&width=32",address:I.IRT},{symbol:"DOGE",name:"دوج کوین",logo:"https://cryptologos.cc/logos/dogecoin-doge-logo.svg",address:I.DOGE},{symbol:"BTC",name:"بیت کوین",logo:"https://cryptologos.cc/logos/bitcoin-btc-logo.svg",address:I.BTC}]),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(""),[f,x]=(0,s.useState)(!1),[h,p]=(0,s.useState)(""),[g,w]=(0,s.useState)(null),{toast:v}=eG();(0,s.useEffect)(()=>{(()=>{try{let e=localStorage.getItem(eV);if(e){let t=JSON.parse(e);l(e=>[...e.filter(e=>!e.isCustom),...t])}}catch(e){console.error("خطا در بارگذاری توکن‌های سفارشی:",e)}})()},[]);let y=e=>{try{localStorage.setItem(eV,JSON.stringify(e))}catch(e){console.error("خطا در ذخیره توکن‌های سفارشی:",e)}},b=(e,t)=>{i(e),a&&a(e,t)},j=o.find(e=>e.symbol===n)||o[0],A=async()=>{x(!0),p(""),w(null);try{if(!u||!u.startsWith("0x")||42!==u.length){p("آدرس قرارداد نامعتبر است");return}if(o.find(e=>e.address.toLowerCase()===u.toLowerCase())){p("این توکن قبلاً به لیست اضافه شده است");return}if(!await ei(u)){p("آدرس وارد شده یک توکن ERC20 معتبر نیست");return}let e=await eo(u);w({symbol:e.symbol,name:e.name,logo:"/placeholder.svg?height=32&width=32",address:u,isCustom:!0})}catch(e){console.error("خطا در بررسی آدرس توکن:",e),p("خطا در بررسی آدرس توکن. لطفاً دوباره تلاش کنید.")}finally{x(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(em,{children:[(0,r.jsx)(ef,{className:"rounded-l-none",asChild:!0,children:(0,r.jsxs)(N,{variant:"outline",className:"min-w-24 flex items-center gap-2",children:[(0,r.jsx)(eF.default,{src:j.logo||"/placeholder.svg",alt:n,width:20,height:20,className:"rounded-full"}),n,(0,r.jsx)(ek.A,{className:"h-4 w-4"})]})}),(0,r.jsxs)(ex,{className:"rounded-l-none",align:"end",children:[o.map(e=>(0,r.jsxs)(eh,{onClick:()=>b(e.symbol,e.address),className:"cursor-pointer flex items-center gap-2",children:[(0,r.jsx)(eF.default,{src:e.logo||"/placeholder.svg",alt:e.symbol,width:20,height:20,className:"rounded-full"}),(0,r.jsx)("span",{children:e.symbol}),(0,r.jsx)("span",{className:"text-muted-foreground text-xs mr-2",children:e.name}),e.isCustom&&(0,r.jsx)("span",{className:"text-xs text-primary ml-auto",children:"سفارشی"})]},e.symbol)),(0,r.jsx)(ep,{}),(0,r.jsxs)(eh,{onClick:()=>d(!0),className:"cursor-pointer flex items-center gap-2 text-primary",children:[(0,r.jsx)(eS.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"افزودن توکن سفارشی"})]})]})]}),(0,r.jsx)(eT,{open:c,onOpenChange:d,children:(0,r.jsxs)(eL,{className:"sm:max-w-md",dir:"rtl",children:[(0,r.jsxs)(eR,{children:[(0,r.jsx)(e_,{children:"افزودن توکن سفارشی"}),(0,r.jsx)(eU,{children:"آدرس قرارداد توکن ERC20 را وارد کنید تا به لیست توکن‌ها اضافه شود."})]}),(0,r.jsxs)("div",{className:"space-y-4 py-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(eA,{htmlFor:"tokenAddress",children:"آدرس قرارداد توکن"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(eN,{id:"tokenAddress",placeholder:"0x...",value:u,onChange:e=>m(e.target.value),dir:"ltr"}),(0,r.jsx)(N,{type:"button",variant:"outline",onClick:A,disabled:f||!u,children:f?(0,r.jsx)(r.Fragment,{children:"بررسی..."}):(0,r.jsx)(r.Fragment,{children:"بررسی"})})]}),h&&(0,r.jsxs)("div",{className:"text-destructive text-sm flex items-center gap-1 mt-1",children:[(0,r.jsx)(eB.A,{className:"h-4 w-4"}),h]})]}),g&&(0,r.jsxs)("div",{className:"bg-secondary/50 p-3 rounded-md space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"نماد:"}),(0,r.jsx)("span",{children:g.symbol})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"نام:"}),(0,r.jsx)("span",{children:g.name})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:"آدرس:"}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground truncate max-w-[200px]",dir:"ltr",children:g.address})]})]})]}),(0,r.jsxs)(eD,{className:"sm:justify-between",children:[(0,r.jsx)(N,{type:"button",variant:"outline",onClick:()=>d(!1),children:"انصراف"}),(0,r.jsxs)(N,{type:"button",onClick:()=>{if(!g)return;let e=[...o,g];l(e),y(e.filter(e=>e.isCustom)),i(g.symbol),a&&a(g.symbol,g.address),d(!1),m(""),w(null),v({title:"توکن اضافه شد",description:"توکن ".concat(g.symbol," با موفقیت به لیست اضافه شد.")})},disabled:!g,children:[(0,r.jsx)(ed.A,{className:"h-4 w-4 ml-2"}),"افزودن توکن"]})]})]})})]})}function eY(e){let{id:t,label:a,value:s,token:n,balance:i,onChange:o,onTokenSelect:l,extraInfo:c,isCalculating:d=!1,readOnly:u=!1}=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(eA,{htmlFor:t,children:a}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["موجودی:"," ",(0,r.jsxs)("span",{dir:"ltr",className:"font-mono",children:[(e=>{let t=Number.parseFloat(e);return isNaN(t)?"0":t.toFixed(6)})(i)," ",n]})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2 space-x-reverse relative",dir:"ltr",children:[(0,r.jsx)(eN,{id:t,type:"number",lang:"en",placeholder:"0.0",value:s,onChange:o,readOnly:u,className:"flex-1 rounded-r-none border-r-0 font-mono ".concat(u?"bg-muted cursor-not-allowed":"")}),(0,r.jsx)(eW,{defaultToken:n,onSelect:l}),d&&(0,r.jsx)("div",{className:"absolute inset-y-0 right-24 flex items-center pr-3",children:(0,r.jsx)(g.A,{className:"h-4 w-4 animate-spin text-primary"})})]}),c]})}let eK={ETH:3,BTC:4,SOL:2,USDT:1,IRT:1,DOGE:0};function eQ(e){let{tokenA:t,tokenB:a,tokenAAddress:n,tokenBAddress:i,balanceA:o,balanceB:l,poolExists:c,exchangeRate:d,onTokenASelect:u,onTokenBSelect:m,onSwap:f,calculateOutput:x,disabled:h,account:p}=e,[w,v]=(0,s.useState)(""),[y,b]=(0,s.useState)(""),[j,A]=(0,s.useState)("AtoB"),[k,S]=(0,s.useState)("0.5"),[B,F]=(0,s.useState)("0"),[E,C]=(0,s.useState)(!1),[T,I]=(0,s.useState)(!1),O=async e=>{if(S(e),"AtoB"===j&&w&&Number.parseFloat(w)>0||"BtoA"===j&&y&&Number.parseFloat(y)>0){let t="AtoB"===j?w:y;I(!0);try{let{outputAmount:a,minAmountOut:r}=await x(t,"AtoB"===j,e);F(r),"AtoB"===j?b(a):v(a)}catch(e){console.error("Error recalculating with new slippage:",e)}finally{I(!1)}}},L=async e=>{if(A("AtoB"),v(e.target.value),!e.target.value||0>=Number.parseFloat(e.target.value)){b(""),F("0");return}I(!0);try{let{outputAmount:t,minAmountOut:a}=await x(e.target.value,!0,k);b(t),F(a)}finally{I(!1)}},R=async e=>{if(A("BtoA"),b(e.target.value),!e.target.value||0>=Number.parseFloat(e.target.value)){v(""),F("0");return}I(!0);try{let{outputAmount:t,minAmountOut:a}=await x(e.target.value,!1,k);v(t),F(a)}finally{I(!1)}},D=async()=>{C(!0);try{!await f("AtoB"===j?w:y,B,"AtoB"===j,()=>{v(""),b(""),F("0")})||w||y||(v(""),b(""),F("0"))}finally{C(!1)}},_=e=>{let t=Number.parseFloat(e);return isNaN(t)?"0":t.toFixed(6)};return(0,r.jsxs)("div",{className:"space-y-4",dir:"rtl",children:[(0,r.jsx)(eY,{id:"tokenA",label:"از",value:w,token:t,balance:o,onChange:L,onTokenSelect:u,isCalculating:"BtoA"===j&&T,readOnly:"BtoA"===j,extraInfo:"BtoA"===j&&y&&Number.parseFloat(y)>0&&c&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground text-right mt-1",children:["شما دریافت خواهید کرد: حداقل"," ",(0,r.jsxs)("span",{dir:"ltr",className:"inline-block font-mono",children:[_(B)," ",t]})]})}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(N,{variant:"outline",size:"icon",className:"rounded-full",onClick:()=>{u(a,i),m(t,n),v(y),b(w),A("AtoB"===j?"BtoA":"AtoB")},children:(0,r.jsx)(ev.A,{className:"h-4 w-4"})})}),(0,r.jsx)(eY,{id:"tokenB",label:"به",value:y,token:a,balance:l,onChange:R,onTokenSelect:m,isCalculating:"AtoB"===j&&T,readOnly:"AtoB"===j,extraInfo:"AtoB"===j&&w&&Number.parseFloat(w)>0&&c&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground text-right mt-1",children:["شما دریافت خواهید کرد: حداقل"," ",(0,r.jsxs)("span",{dir:"ltr",className:"inline-block font-mono",children:[_(B)," ",a]})]})}),p?!c&&(0,r.jsx)("div",{className:"p-3 bg-destructive/20 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(ey.A,{className:"h-4 w-4 mt-0.5 text-destructive"}),(0,r.jsx)("div",{className:"text-sm",dir:"rtl",children:(0,r.jsx)("p",{children:"استخر برای این جفت توکن وجود ندارد. لطفا ابتدا نقدینگی اضافه کنید."})})]})}):(0,r.jsx)("div",{className:"p-3 bg-destructive/20 rounded-lg",dir:"rtl",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(ey.A,{className:"h-4 w-4 mt-0.5 text-destructive"}),(0,r.jsx)("div",{className:"text-sm",children:(0,r.jsx)("p",{children:"برای شروع مبادله کیف‌پول خود را متصل کنید."})})]})}),c&&(w&&Number.parseFloat(w)>0||y&&Number.parseFloat(y)>0)&&(0,r.jsxs)("div",{className:"p-3 bg-secondary rounded-lg space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"نرخ تبدیل"}),(()=>{var e,s;let n=null!==(e=eK[t])&&void 0!==e?e:-1,i=null!==(s=eK[a])&&void 0!==s?s:-1;if(w&&y&&Number.parseFloat(w)>0&&Number.parseFloat(y)>0){if(n>=i){let e=(Number.parseFloat(y)/Number.parseFloat(w)).toFixed(6);return(0,r.jsxs)("span",{dir:"ltr",className:"font-mono",children:["1 ",t," = ",e," ",a]})}{let e=(Number.parseFloat(w)/Number.parseFloat(y)).toFixed(6);return(0,r.jsxs)("span",{dir:"ltr",className:"font-mono",children:["1 ",a," = ",e," ",t]})}}return(0,r.jsxs)("span",{dir:"ltr",className:"font-mono",children:["1 ",t," = ",Number.parseFloat(d).toFixed(6)," ",a]})})()]}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"حداکثر لغزش"}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("div",{className:"flex border rounded-md overflow-hidden",children:[(0,r.jsx)("button",{type:"button",className:"px-2 py-1 text-xs ".concat("0.1"===k?"bg-primary text-primary-foreground":"bg-background"),onClick:()=>O("0.1"),children:"0.1%"}),(0,r.jsx)("button",{type:"button",className:"px-2 py-1 text-xs ".concat("0.5"===k?"bg-primary text-primary-foreground":"bg-background"),onClick:()=>O("0.5"),children:"0.5%"}),(0,r.jsx)("button",{type:"button",className:"px-2 py-1 text-xs ".concat("1.0"===k?"bg-primary text-primary-foreground":"bg-background"),onClick:()=>O("1.0"),children:"1.0%"})]})})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"حداقل دریافتی"}),(0,r.jsxs)("span",{dir:"ltr",className:"font-mono",children:[_(B)," ","AtoB"===j?a:t]})]})]}),(0,r.jsx)(N,{className:"w-full",onClick:D,disabled:h||!c||E||!w||!y||T,children:E||T?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.A,{className:"ml-2 h-4 w-4 animate-spin"}),E?"در حال مبادله...":"در حال محاسبه..."]}):"مبادله"})]})}var e$=a(610),e0=a(7825),e1=a(8842),e2=a(6261),e5=a(312),e4=a(434);let e6=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:n=!0,...o}=e;return(0,r.jsx)(e4.b,{ref:t,decorative:n,orientation:s,className:i("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...o})});function e3(e){let{exists:t,tokenA:a,tokenB:s,reservoirA:n,reservoirB:i,lpTokens:l,totalLpSupply:c}=e,d=e=>{let t=Number.parseFloat(e);return isNaN(t)?"0":t.toFixed(6)};if(!t)return(0,r.jsx)(o,{className:"bg-secondary/50 border-dashed border-muted",children:(0,r.jsxs)(u,{className:"p-6 text-center",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)(e$.A,{className:"h-12 w-12 text-muted-foreground opacity-50"})}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-2",children:"استخری وجود ندارد"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"برای این جفت توکن استخری وجود ندارد. با افزودن نقدینگی، استخر جدیدی ایجاد خواهید کرد."})]})});let m=(()=>{let e=Number.parseFloat(l),a=Number.parseFloat(c);return!t||isNaN(e)||e<=0||isNaN(a)||a<=0?"0":(e/a*100).toFixed(2)})();return(0,r.jsx)(o,{className:"border-primary/20",children:(0,r.jsxs)(u,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between my-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"اطلاعات استخر"}),(0,r.jsx)("div",{className:"flex items-center gap-1 text-primary",children:(0,r.jsx)(e$.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-secondary/50 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(e0.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"موجودی استخر"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"bg-background/50 rounded p-2",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mb-1",children:["توکن ",a]}),(0,r.jsx)("div",{className:"font-medium",children:d(n)})]}),(0,r.jsxs)("div",{className:"bg-background/50 rounded p-2",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mb-1",children:["توکن ",s]}),(0,r.jsx)("div",{className:"font-medium",children:d(i)})]})]})]}),(0,r.jsx)(e6,{}),(0,r.jsxs)("div",{className:"bg-secondary/50 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(e5.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"سهم شما از استخر"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"bg-background/50 rounded p-2",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"توکن‌های LP"}),(0,r.jsx)("div",{className:"font-medium",children:d(l)})]}),(0,r.jsxs)("div",{className:"bg-background/50 rounded p-2",children:[(0,r.jsx)("div",{className:"text-xs text-muted-foreground mb-1",children:"درصد سهم"}),(0,r.jsxs)("div",{className:"font-medium",children:[m,"%"]})]})]})]}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground text-center mt-2",children:"با افزودن یا برداشت نقدینگی، تعداد توکن‌های LP و سهم شما از استخر تغییر می‌کند."})]})]})})}function e8(e){let{tokenA:t,tokenB:a,tokenAAddress:o,tokenBAddress:l,balanceA:c,balanceB:d,poolExists:u,reservoirA:m,reservoirB:f,lpTokens:x,totalLpSupply:h,onTokenASelect:p,onTokenBSelect:w,onAddLiquidity:v,onRemoveLiquidity:y,estimateLPTokens:b,disabled:j,isExpanded:A,showPoolInfo:k,onToggleExpand:S,onGetRemovalPreview:B}=e,[F,E]=(0,s.useState)(""),[C,T]=(0,s.useState)(""),[I,O]=(0,s.useState)(!1),[L,R]=(0,s.useState)(!1),[D,_]=(0,s.useState)({amountA:"0",amountB:"0"}),[U,M]=(0,s.useState)(""),[P,q]=(0,s.useState)(!1),[z,H]=(0,s.useState)("0"),[J,Z]=(0,s.useState)(!1),[X,G]=(0,s.useState)(null),V=(e,t)=>{if(!u||!e||0>=Number.parseFloat(e)||!m||!f||0>=Number.parseFloat(m)||0>=Number.parseFloat(f))return"0";try{let a=Number.parseFloat(e),r=Number.parseFloat(m),s=Number.parseFloat(f);if(t)return(a*s/r).toString();return(a*r/s).toString()}catch(e){return console.error("Error calculating optimal amount:",e),"0"}},W=async()=>{O(!0);try{!await v(F,C,()=>{E(""),T(""),H("0")})||F||C||(E(""),T(""),H("0"))}finally{O(!1)}},Y=async()=>{if(!(!U||0>=Number(U))){R(!0);try{await y(U,()=>{M(""),_({amountA:"0",amountB:"0"})})}finally{R(!1)}}};return(0,s.useEffect)(()=>{let e=async()=>{if(F&&C&&Number.parseFloat(F)>0&&Number.parseFloat(C)>0){Z(!0);try{let e=await b(F,C);H(e)}catch(e){console.error("Error estimating LP tokens:",e),H("0")}finally{Z(!1)}}else H("0")},t=setTimeout(()=>{e()},500);return()=>clearTimeout(t)},[F,C,b]),(0,s.useEffect)(()=>{let e=async()=>{if(U&&Number(U)>0){q(!0);try{let e=await B(U);_(e)}catch(e){console.error("Error fetching preview:",e),_({amountA:"0",amountB:"0"})}finally{q(!1)}}else _({amountA:"0",amountB:"0"})},t=setTimeout(()=>{e()},500);return()=>clearTimeout(t)},[U,B]),(0,r.jsx)("div",{className:"relative",dir:"rtl",children:(0,r.jsxs)("div",{className:i("grid transition-all duration-500 ease-in-out gap-6",A?"md:grid-cols-2":"grid-cols-1"),children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(eY,{id:"liquidityTokenA",label:"توکن اول",value:F,token:t,balance:c,onChange:e=>{let t=e.target.value;E(t),G("A"),u&&t&&Number.parseFloat(t)>0?T(V(t,!0)):(!t||0>=Number.parseFloat(t))&&T("")},onTokenSelect:p}),(0,r.jsx)(eY,{id:"liquidityTokenB",label:"توکن دوم",value:C,token:a,balance:d,onChange:e=>{let t=e.target.value;T(t),G("B"),u&&t&&Number.parseFloat(t)>0?E(V(t,!1)):(!t||0>=Number.parseFloat(t))&&E("")},onTokenSelect:w}),u&&(0,r.jsxs)("div",{className:"p-3 bg-secondary/50 rounded-lg border border-primary/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)(ey.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"نسبت استخر"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"نسبت فعلی:"}),(0,r.jsxs)("span",{dir:"ltr",className:"text-sm font-medium font-mono",children:["1 ",t," ="," ",Number.parseFloat(m)>0?(Number.parseFloat(f)/Number.parseFloat(m)).toFixed(6):"0"," ",a]})]})]}),F&&C&&Number.parseFloat(F)>0&&Number.parseFloat(C)>0&&(0,r.jsxs)("div",{className:"p-3 bg-secondary/50 rounded-lg border border-primary/10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)(ey.A,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"تخمین توکن‌های LP"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"توکن‌های LP دریافتی:"}),J?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(g.A,{className:"h-3 w-3 animate-spin ml-1"}),(0,r.jsx)("span",{className:"text-sm",children:"در حال محاسبه..."})]}):(0,r.jsx)("span",{dir:"ltr",className:"text-sm font-medium font-mono",children:n(z)})]})]}),(0,r.jsx)(N,{className:"w-full",onClick:W,disabled:j||I||!F||!C,children:I?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.A,{className:"ml-2 h-4 w-4 animate-spin"}),"در حال افزودن نقدینگی..."]}):"افزودن نقدینگی"}),u&&(0,r.jsxs)("div",{className:"mt-6 p-4 bg-secondary/50 rounded-lg border border-primary/10",children:[(0,r.jsxs)("h3",{className:"text-md font-medium mb-3 flex items-center",children:[(0,r.jsx)(e$.A,{className:"h-5 w-5 ml-2 text-primary"}),"برداشت نقدینگی"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"number",placeholder:"مقدار توکن LP",value:U,onChange:e=>M(e.target.value),className:"flex-1 px-3 py-2 bg-background rounded-lg text-sm font-mono",dir:"rtl"}),(0,r.jsxs)("span",{className:"mr-2 text-sm flex items-center",children:[(0,r.jsx)(e0.A,{className:"h-4 w-4 ml-1"}),"LP"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[(0,r.jsxs)("div",{className:"bg-background/50 rounded p-2 border border-primary/5",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mb-1 flex items-center",children:[(0,r.jsx)(e1.A,{className:"h-3 w-3 ml-1 text-primary"}),"توکن ",t]}),P?(0,r.jsx)("div",{className:"flex justify-center py-1",children:(0,r.jsx)(g.A,{className:"h-4 w-4 animate-spin text-primary"})}):(0,r.jsx)("div",{dir:"ltr",className:"font-medium font-mono",children:n(D.amountA)})]}),(0,r.jsxs)("div",{className:"bg-background/50 rounded p-2 border border-primary/5",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mb-1 flex items-center",children:[(0,r.jsx)(e1.A,{className:"h-3 w-3 ml-1 text-primary"}),"توکن ",a]}),P?(0,r.jsx)("div",{className:"flex justify-center py-1",children:(0,r.jsx)(g.A,{className:"h-4 w-4 animate-spin text-primary"})}):(0,r.jsx)("div",{dir:"ltr",className:"font-medium font-mono",children:n(D.amountB)})]})]}),(0,r.jsx)(N,{className:"w-full mt-2",variant:"default",onClick:Y,disabled:j||L||!U||0>=Number(U)||Number(U)>Number(x),children:L?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.A,{className:"ml-2 h-4 w-4 animate-spin"}),"در حال برداشت نقدینگی..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e2.A,{className:"ml-2 h-4 w-4"}),"برداشت نقدینگی"]})}),Number(U)>Number(x)&&(0,r.jsxs)("div",{className:"text-xs text-destructive mt-1",children:["مقدار وارد شده بیشتر از موجودی شما (",n(x)," LP) است."]})]})]})]}),(0,r.jsx)("div",{className:i("transition-opacity duration-300 h-full",k&&A?"opacity-100":"opacity-0 md:absolute md:pointer-events-none"),children:(0,r.jsx)(e3,{exists:u,tokenA:t,tokenB:a,reservoirA:m,reservoirB:f,lpTokens:x,totalLpSupply:h})})]})})}e6.displayName=e4.b.displayName;var e9=a(1773),e7=a(1466),te=a(6889),tt=a(7364);let ta={ETH:3,BTC:4,SOL:2,USDT:1,IRT:1,DOGE:0};function tr(e){let{tokenA:t,tokenB:a,tokenAAddress:i,tokenBAddress:l,poolExists:c,getSwapEvents:d,disabled:u,account:m}=e,[f,x]=(0,s.useState)([]),[h,p]=(0,s.useState)(!1),[w,v]=(0,s.useState)(null),[y,b]=(0,s.useState)(!1),j=async()=>{if(!c||u){x([]);return}p(!0),b(!0),v(null);try{let e=await d();Array.isArray(e)?x(e.reverse().slice(0,5)):(console.error("Invalid events data:",e),v("دریافت داده‌های نامعتبر. لطفا دوباره تلاش کنید."),x([]))}catch(e){console.error("Error fetching swap events:",e),v("خطا در دریافت تاریخچه مبادلات. لطفا دوباره تلاش کنید."),x([])}finally{p(!1),b(!1)}};(0,s.useEffect)(()=>{(async()=>{if(!c||u){x([]);return}p(!0),b(!0),v(null);try{let e=await d();Array.isArray(e)?x(e.reverse().slice(0,5)):(console.error("Invalid events data:",e),v("دریافت داده‌های نامعتبر. لطفا دوباره تلاش کنید."),x([]))}catch(e){console.error("Error fetching swap events:",e),v("خطا در دریافت تاریخچه مبادلات. لطفا دوباره تلاش کنید."),x([])}finally{p(!1),b(!1)}})()},[c,i,l,m]);let A=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",k=e=>e?new Date(1e3*e).toLocaleString("fa-IR"):"",S=e=>e.toLowerCase()===(null==m?void 0:m.toLowerCase());return(0,r.jsxs)("div",{className:"space-y-4",dir:"rtl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"تاریخچه مبادلات"}),(0,r.jsxs)(N,{variant:"outline",size:"sm",onClick:j,disabled:h||!c||u,children:[h?(0,r.jsx)(g.A,{className:"h-4 w-4 animate-spin ml-2"}):(0,r.jsx)(e9.A,{className:"h-4 w-4 ml-2"}),"بروزرسانی"]})]}),c?h?(0,r.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,r.jsx)(g.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("span",{className:"mr-2",children:"در حال بارگذاری تاریخچه..."})]}):w?(0,r.jsx)(o,{className:"p-6 text-center bg-destructive/20 border-dashed",children:(0,r.jsx)("p",{className:"text-destructive",children:w})}):0===f.length?(0,r.jsx)(o,{className:"p-6 text-center bg-secondary/50 border-dashed",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"هیچ مبادله‌ای برای این جفت توکن یافت نشد."})}):(0,r.jsx)("div",{className:"space-y-3",children:f.map(e=>{var t,a;return(0,r.jsx)(o,{className:"p-4 border ".concat(S(e.user)?"border-primary/30 bg-primary/5":"border-border"),children:(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(e7.A,{className:"h-4 w-4 ml-1 text-muted-foreground"}),S(e.user)?(0,r.jsx)("span",{className:"text-sm font-medium",children:"شما"}):(0,r.jsx)("a",{href:"https://zanjir.xyz/explorer/address/".concat(e.user),target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium hover:text-primary hover:underline flex items-center",children:A(e.user)}),S(e.user)&&(0,r.jsx)("span",{className:"mr-2 text-xs bg-primary/20 text-primary px-2 py-0.5 rounded-full",children:"تراکنش شما"})]}),(0,r.jsxs)("div",{className:"flex items-center text-xs text-muted-foreground",children:[(0,r.jsx)(te.A,{className:"h-3 w-3 ml-1"}),(0,r.jsx)("span",{dir:"ltr",children:k(e.timestamp)})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-[1fr,auto,1fr] items-center gap-2 mt-2",children:[(0,r.jsx)("div",{className:"text-right",children:(0,r.jsxs)("span",{className:"text-sm font-medium",dir:"ltr",children:[n(e.amountIn)," ",e.tokenIn]})}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(tt.A,{className:"h-4 w-4 text-primary"})}),(0,r.jsx)("div",{className:"text-left",children:(0,r.jsxs)("span",{className:"text-sm font-medium",dir:"ltr",children:[n(e.amountOut)," ",e.tokenOut]})})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:["نرخ:"," ",(0,r.jsx)("span",{dir:"ltr",className:"font-mono",children:(null!==(t=ta[e.tokenIn])&&void 0!==t?t:-1)>=(null!==(a=ta[e.tokenOut])&&void 0!==a?a:-1)?"1 ".concat(e.tokenIn," = ").concat((Number(e.amountOut)/Number(e.amountIn)).toFixed(6)," ").concat(e.tokenOut):"1 ".concat(e.tokenOut," = ").concat((Number(e.amountIn)/Number(e.amountOut)).toFixed(6)," ").concat(e.tokenIn)})]}),e.txHash&&(0,r.jsx)("a",{href:"https://zanjir.xyz/explorer/tx/".concat(e.txHash),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline",dir:"ltr",children:"مشاهده تراکنش"})]})]})},e.id)})}):(0,r.jsx)(o,{className:"p-6 text-center bg-secondary/50 border-dashed",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"استخری برای این جفت توکن وجود ندارد."})})]})}let ts=async(e,t)=>{try{let a,r;let{tokenA:s,tokenB:n,swapped:i}=H(e,t);if(!await J(s,n))return{exists:!1,reservoirA:"0",reservoirB:"0",exchangeRate:"0"};let{contract:o}=await G(s,n),l=await o.reserveA(),c=await o.reserveB(),d=await V(s),u=await V(n),m=await d.decimals(),f=await u.decimals();void 0!==A.utils?(a=A.utils.formatUnits(l,m),r=A.utils.formatUnits(c,f)):(a=B.Js(l,m),r=B.Js(c,f));let[x,h]=await o.getExchangeRate(),p="0";return p=void 0!==A.utils?A.utils.formatUnits(x,18):B.Js(x,18),{exists:!0,reservoirA:a,reservoirB:r,exchangeRate:p,swapped:i}}catch(e){return console.error("خطا در دریافت اطلاعات استخر:",e),{exists:!1,reservoirA:"0",reservoirB:"0",exchangeRate:"0",swapped:!1}}};function tn(){let[e,t]=(0,s.useState)("swap"),[a,n]=(0,s.useState)("ETH"),[m,w]=(0,s.useState)("USDT"),[v,y]=(0,s.useState)(I.ETH),[N,b]=(0,s.useState)(I.USDT),[j,k]=(0,s.useState)(!1),[S,F]=(0,s.useState)(!1),{connected:E,account:C,isCorrectNetwork:T,connect:O,disconnect:D,switchNetwork:U}=function(){let[e,t]=(0,s.useState)(!1),[a,r]=(0,s.useState)(""),[n,i]=(0,s.useState)(!1),[o,l]=(0,s.useState)(!1),{toast:c}=eG(),d=(0,s.useCallback)(()=>{r(""),t(!1)},[]);(0,s.useEffect)(()=>{(async()=>{if(window.ethereum)try{let{connected:e,account:a}=await q();t(e),r(a||"");let s=await R();i(s);let n=e=>{e.length>0?(t(!0),r(e[0])):d()},o=async()=>{let e=await R();i(e)};return window.ethereum.removeListener("accountsChanged",n),window.ethereum.removeListener("chainChanged",o),window.ethereum.on("accountsChanged",n),window.ethereum.on("chainChanged",o),()=>{window.ethereum&&(window.ethereum.removeListener("accountsChanged",n),window.ethereum.removeListener("chainChanged",o))}}catch(e){console.error("خطا در بررسی اتصال کیف پول:",e)}})()},[d]);let u=async()=>{if(!e){l(!0);try{await R()||await _();let e=await M();return t(!0),r(e),i(!0),c({title:"کیف پول متصل شد",description:"شما با موفقیت به شبکه Zanjir متصل شدید."}),e}catch(e){return console.error("خطا در اتصال به کیف پول:",e),c({title:"خطا",description:"خطا در اتصال به کیف پول یا تغییر شبکه. لطفا دوباره تلاش کنید.",variant:"destructive"}),null}finally{l(!1)}}};return{connected:e,account:a,isCorrectNetwork:n,isConnecting:o,connect:u,disconnect:async()=>{try{await P(),d(),c({title:"قطع اتصال",description:"اتصال کیف پول با موفقیت قطع شد."})}catch(e){console.error("خطا در قطع اتصال کیف پول:",e)}},switchNetwork:async()=>{try{return await _(),i(!0),!0}catch(e){return console.error("خطا در تغییر شبکه:",e),!1}}}}(),{poolExists:z,isLoading:H,reservoirA:Z,reservoirB:X,exchangeRate:V,balanceA:Y,balanceB:ei,lpTokens:eo,totalLpSupply:el,calculateOutput:ec,swap:ed,addLiquidity:eu,removeLiquidity:em,getRemoveLiquidityPreview:ef,estimateLPTokens:ex,getSwapEvents:eh}=function(e){let{connected:t,account:a,isCorrectNetwork:r,tokenAAddress:n,tokenBAddress:i}=e,[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)("0"),[f,x]=(0,s.useState)("0"),[h,p]=(0,s.useState)("0"),[g,w]=(0,s.useState)("0"),[v,y]=(0,s.useState)("0"),[N,b]=(0,s.useState)("0"),{toast:j}=eG(),[k,S]=(0,s.useState)("0"),F=(0,s.useCallback)(()=>{let e=n.toLowerCase()<i.toLowerCase(),[t,a]=e?[n,i]:[i,n];return{firstToken:t,secondToken:a,isOriginalOrder:e}},[n,i]),E=(0,s.useCallback)(async()=>{if(t&&n&&i&&r&&a){d(!0);try{let{firstToken:e,secondToken:t,isOriginalOrder:r}=F(),s=await J(e,t);if(l(s),s){let s=await ts(e,t);if(r)m(s.reservoirA),x(s.reservoirB),p(s.exchangeRate);else{m(s.reservoirB),x(s.reservoirA);let e=Number.parseFloat(s.exchangeRate)>0?(1/Number.parseFloat(s.exchangeRate)).toString():"0";p(e)}if(a){let r;let s=await ee(e,t,a);b(s);let{contract:n}=await G(e,t),i=await n.totalSupply();r=void 0!==A.utils?A.utils.formatEther(i):B.ck(i),S(r)}}else m("0"),x("0"),p("0"),b("0"),S("0");if(a){let e=await W(n,a),t=await W(i,a);w(e),y(t)}}catch(e){console.error("خطا در دریافت اطلاعات استخر و موجودی‌ها:",e),j({title:"خطا",description:"خطا در دریافت اطلاعات. لطفا دوباره تلاش کنید.",variant:"destructive"})}finally{d(!1)}}},[t,a,n,i,r,j,F]);(0,s.useEffect)(()=>{t&&a&&E()},[t,a,n,i,r,E]);let C=(0,s.useCallback)(async(e,t,a)=>{if(!o||!e||0>=Number.parseFloat(e))return{outputAmount:"0",minAmountOut:"0",isLoading:!1};try{let r=await en(n,i,e,t);if(null===r)return console.error("خطا در دریافت مقدار دقیق از قرارداد"),{outputAmount:"0",minAmountOut:"0",isLoading:!1};{let e=function(e,t){try{let a=Number.parseFloat(e),r=Number.parseFloat(t)/100;if(isNaN(a)||isNaN(r))return"0";let s=(e.split(".")[1]||"").length;return(a*(1-r)).toFixed(s)}catch(e){return console.error("خطا در محاسبه حداقل مقدار خروجی:",e),"0"}}(r,a);return{outputAmount:r,minAmountOut:e,isLoading:!1}}}catch(e){return console.error("خطا در محاسبه مقدار خروجی:",e),{outputAmount:"0",minAmountOut:"0",isLoading:!1}}},[o,n,i]),T=(0,s.useCallback)(async(e,a,s,n)=>{if(!t)return j({title:"خطا",description:"لطفا ابتدا کیف پول خود را متصل کنید.",variant:"destructive"}),!1;if(!r)return j({title:"خطا",description:"لطفا به شبکه Zanjir متصل شوید.",variant:"destructive"}),!1;if(!e||!a)return j({title:"خطا",description:"لطفا مقادیر را وارد کنید.",variant:"destructive"}),!1;if(!o)return j({title:"خطا",description:"استخر برای این جفت توکن وجود ندارد. لطفا ابتدا نقدینگی اضافه کنید.",variant:"destructive"}),!1;try{let{firstToken:t,secondToken:r,isOriginalOrder:i}=F();return i&&s||!i&&!s?await Q(t,r,e,a):await $(t,r,e,a),j({title:"تراکنش موفق",description:"مبادله با موفقیت انجام شد."}),n&&"function"==typeof n&&n(),E(),!0}catch(e){return console.error("خطا در مبادله:",e),j({title:"خطا",description:"خطا در انجام مبادله. لطفا دوباره تلاش کنید.",variant:"destructive"}),!1}},[t,r,o,F,E,j]),I=(0,s.useCallback)(async(e,a,s)=>{if(!t)return j({title:"خطا",description:"لطفا ابتدا کیف پول خود را متصل کنید.",variant:"destructive"}),!1;if(!r)return j({title:"خطا",description:"لطفا به شبکه Zanjir متصل شوید.",variant:"destructive"}),!1;if(!e||!a)return j({title:"خطا",description:"لطفا مقادیر را وارد کنید.",variant:"destructive"}),!1;try{let{firstToken:t,secondToken:r,isOriginalOrder:n}=F(),[i,o]=n?[e,a]:[a,e];return await K(t,r,i,o),j({title:"تراکنش موفق",description:"نقدینگی با موفقیت اضافه شد."}),s&&"function"==typeof s&&s(),E(),!0}catch(e){return console.error("خطا در افزودن نقدینگی:",e),j({title:"خطا",description:"خطا در افزودن نقدینگی. لطفا دوباره تلاش کنید.",variant:"destructive"}),!1}},[t,r,F,E,j]),O=(0,s.useCallback)(async(e,a)=>{if(!t)return j({title:"خطا",description:"لطفا ابتدا کیف پول خود را متصل کنید.",variant:"destructive"}),!1;if(!r)return j({title:"خطا",description:"لطفا به شبکه Zanjir متصل شوید.",variant:"destructive"}),!1;if(!o)return j({title:"خطا",description:"استخر برای این جفت توکن وجود ندارد.",variant:"destructive"}),!1;if(!e||0>=Number(e))return j({title:"خطا",description:"لطفا مقدار معتبری وارد کنید.",variant:"destructive"}),!1;if(Number(e)>Number(N))return j({title:"خطا",description:"مقدار وارد شده بیشتر از موجودی شما است.",variant:"destructive"}),!1;try{let{firstToken:t,secondToken:r}=F();return await er(t,r,e),j({title:"تراکنش موفق",description:"نقدینگی با موفقیت برداشت شد."}),a&&"function"==typeof a&&a(),E(),!0}catch(e){return console.error("خطا در برداشت نقدینگی:",e),j({title:"خطا",description:"خطا در برداشت نقدینگی. لطفا دوباره تلاش کنید.",variant:"destructive"}),!1}},[t,r,o,N,F,E,j]),R=(0,s.useCallback)(async e=>{if(!t||!n||!i||!r||!a||!o)return{amountA:"0",amountB:"0"};try{let{firstToken:t,secondToken:a,isOriginalOrder:r}=F(),s=await ea(t,a,e);if(r)return s;return{amountA:s.amountB,amountB:s.amountA}}catch(e){return console.error("خطا در دریافت پیش‌بینی برداشت نقدینگی:",e),{amountA:"0",amountB:"0"}}},[t,a,n,i,r,o,F]);return{poolExists:o,isLoading:c,reservoirA:u,reservoirB:f,exchangeRate:h,balanceA:g,balanceB:v,lpTokens:N,totalLpSupply:k,calculateOutput:C,swap:T,addLiquidity:I,removeLiquidity:O,refreshPool:E,getRemoveLiquidityPreview:R,estimateLPTokens:(0,s.useCallback)(async(e,s)=>{if(!t||!n||!i||!r||!a||!e||!s||0>=Number.parseFloat(e)||0>=Number.parseFloat(s))return"0";try{let{firstToken:t,secondToken:a,isOriginalOrder:r}=F(),[n,i]=r?[e,s]:[s,e];return await es(t,a,n,i)}catch(e){return console.error("خطا در تخمین تعداد توکن‌های LP:",e),"0"}},[t,a,n,i,r,F]),getSwapEvents:async()=>{try{let e,t;if(!o)return[];let{firstToken:a,secondToken:r,isOriginalOrder:s}=F(),l=await et(a,r);try{e=await L(n),t=await L(i)}catch(a){console.error("Error fetching token symbols:",a),e=n,t=i}return l.map((a,r)=>{try{var o,l,c,d;let n=(null===(o=a.args)||void 0===o?void 0:o.isAToB)===void 0||a.args.isAToB,i=s?n:!n,u=i?e:t,m=i?t:e;return{id:"".concat(a.blockNumber||0,"-").concat(r),user:(null===(l=a.args)||void 0===l?void 0:l.user)||"",amountIn:(null===(c=a.args)||void 0===c?void 0:c.amountIn)?void 0!==A.utils?A.utils.formatEther(a.args.amountIn):B.ck(a.args.amountIn):"0",amountOut:(null===(d=a.args)||void 0===d?void 0:d.amountOut)?void 0!==A.utils?A.utils.formatEther(a.args.amountOut):B.ck(a.args.amountOut):"0",timestamp:a.blockTimestamp||Math.floor(Date.now()/1e3),tokenIn:u,tokenOut:m,txHash:a.transactionHash||""}}catch(a){return console.error("Error formatting event:",a),{id:"error-".concat(r),user:"Unknown",amountIn:"0",amountOut:"0",timestamp:Math.floor(Date.now()/1e3),tokenIn:e||n,tokenOut:t||i,txHash:""}}})}catch(e){return console.error("Error getting swap events:",e),[]}}}}({connected:E,account:C,isCorrectNetwork:T,tokenAAddress:v,tokenBAddress:N}),ep=(e,t)=>{n(e),y(t)},ev=(e,t)=>{w(e),b(t)};return(0,r.jsx)("div",{className:i("w-full transition-all duration-500 ease-in-out","liquidity"===e&&j?"md:max-w-4xl mx-auto":"max-w-md mx-auto"),children:(0,r.jsxs)(o,{className:"border-2 border-primary/20",children:[(0,r.jsxs)(l,{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(c,{className:"text-xl",children:"کیوی‌سواپ"}),(0,r.jsx)(eg,{connected:E,account:C,onConnect:O,onDisconnect:D})]}),(0,r.jsx)(d,{children:"مبادله بر بستر زنجیر"}),E&&!T&&(0,r.jsx)(ew,{onSwitchNetwork:U})]}),(0,r.jsx)(u,{children:H?(0,r.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,r.jsx)(g.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("span",{className:"mr-2",children:"در حال بارگذاری..."})]}):(0,r.jsxs)(f,{defaultValue:"swap",value:e,onValueChange:e=>{t(e),"liquidity"===e?setTimeout(()=>{k(!0),setTimeout(()=>{F(!0)},300)},100):(F(!1),setTimeout(()=>{k(!1)},300))},className:"w-full",children:[(0,r.jsxs)(x,{className:"grid w-full grid-cols-3 mb-4",children:[(0,r.jsx)(h,{value:"swap",children:"مبادله"}),(0,r.jsx)(h,{value:"liquidity",children:"نقدینگی"}),(0,r.jsx)(h,{value:"history",children:"تاریخچه"})]}),(0,r.jsx)(p,{value:"swap",children:(0,r.jsx)(eQ,{tokenA:a,tokenB:m,tokenAAddress:v,tokenBAddress:N,balanceA:Y,balanceB:ei,poolExists:z,exchangeRate:V,onTokenASelect:ep,onTokenBSelect:ev,onSwap:ed,calculateOutput:ec,disabled:!E||!T,account:C})}),(0,r.jsx)(p,{value:"liquidity",children:(0,r.jsx)(e8,{tokenA:a,tokenB:m,tokenAAddress:v,tokenBAddress:N,balanceA:Y,balanceB:ei,poolExists:z,reservoirA:Z,reservoirB:X,lpTokens:eo,totalLpSupply:el,onTokenASelect:ep,onTokenBSelect:ev,onAddLiquidity:eu,onRemoveLiquidity:em,onGetRemovalPreview:ef,estimateLPTokens:ex,disabled:!E||!T,isExpanded:j,showPoolInfo:S,onToggleExpand:()=>{j?(F(!1),setTimeout(()=>{k(!1)},300)):(k(!0),setTimeout(()=>{F(!0)},300))}})}),(0,r.jsx)(p,{value:"history",children:(0,r.jsx)(tr,{tokenA:a,tokenB:m,tokenAAddress:v,tokenBAddress:N,poolExists:z,getSwapEvents:eh,disabled:!E||!T,account:C})})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[261,441,517,358],()=>t(3061)),_N_E=e.O()}]);